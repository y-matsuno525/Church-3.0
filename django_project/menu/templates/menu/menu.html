{% extends "base.html" %}

{% block main %}
<div class="container my-5">
    <div class="row">
        <!-- 左側のページ一覧 -->
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
            <div class="sidebar-sticky">
                <!-- ドロップダウンメニュー -->
                <select name="example" class="form-select my-3">
                    <option value="JCO">JCO</option>
                    <option value="KJV">KJV</option>
                    <option value="ASV">ASV</option>
                </select>
                <!-- 論文作成タイトル -->
                <h3 class="text-center mt-3">論文作成</h3>
                <!-- 書籍一覧 -->
                <ul class="nav flex-column">
                    {% for book in books %}
                        <li class="nav-item">
                            <a class="nav-link book-link" href="#" data-book-id="{{ book.id }}">{{ book.name }}</a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </nav>

        <!-- メインコンテンツ -->
        <div class="col-md-10">
            <!-- ヘッダーセクション -->
            <div class="text-center mb-4">
                <h1 class="display-5 fw-bold">Menu</h1>
            </div>
        </div>
    </div>
</div>

<!-- jQueryを使用 -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    //.readyでHTML読み込みが完了するまで待機する
    $(document).ready(function () {
        // 書名リンクがクリックされたときのイベント
        $(".book-link").on("click", function (e) {
            e.preventDefault(); // デフォルトのリンク動作を無効化

            var bookId = $(this).data("book-id"); // 書籍IDを取得

            // Ajaxリクエストを送信
            $.ajax({
                url: "{% url 'book_content' %}", // 書の内容を取得するビューのURL（後述）
                method: "GET",
                data: {
                    book_id: bookId // 書籍IDを送信
                },
                success: function (response) {
                    // メインコンテンツエリアに書の内容を表示
                    $("#main-content").html(response.html);
                },
                error: function (xhr, status, error) {
                    console.error("エラーが発生しました:", error);
                    $("#main-content").html("<p>内容を取得できませんでした。</p>");
                }
            });
        });
    });
</script>
{% endblock %}
